/*
 yerbajs - simple javascript data management
  @copyright 2014 Kevin von Flotow <vonflow@gmail.com>
  @license MIT License <http://opensource.org/licenses/MIT>
*/
(function(e){function b(a){this._init(a)}var c=Date.prototype.toISOString?"toISOString":"getTime";b.prototype={_init:function(a){a=a||[];this.indices={_id:{}};for(var d=this.length=this.lastUpdate=0,g=a.length;d<g;d++)this.add(a[d])},_setLastUpdate:function(){this.lastUpdate=(new Date)[c]()},_generateUID:function(){for(var a=e.genUID();this.get(a);a=e.genUID());return a},reIndex:function(){this.indices={_id:{}};this.each(function(a,d){this.indices._id[d._id]=a});return this},each:function(a){for(var d=
0,g=this.length;d<g;++d){var b=a.call(this,d,this[d]);if(!b&&"undefined"!==typeof b)break}return this},get:function(a){return this.indices._id.hasOwnProperty(a)?this[this.indices._id[a]]:!1},find:function(a){if(!a)return!1;var d=void 0,b={},c=function(a){};isFunction(a)?c=a:(d="undefined"!==typeof a.query?a.query:d,b=a.opts||b,c=a.done||c);b.caseSensitive="undefined"!==typeof b.caseSensitive?b.caseSensitive:!0;b.limit="undefined"!==typeof b.limit&&e.isNumber(b.limit)?b.limit|0:0;var h=[];this.each(function(a,
c){var k=0,l=0;if(e.isString(d)||e.isNumber(d))k=1,"undefined"!==typeof c.data&&c.data==d&&(l=1);else for(var f in d)c.hasOwnProperty(f)&&(b.caseSensitive&&c[f]===d[f]||!b.caseSensitive&&c[f].toLowerCase()===d[f].toLowerCase())&&l++,k++;if(l===k&&(h.push(c),0<b.limit&&h.length>=b.limit))return!1});c.call(this,h);return this},shuffle:function(){for(var a=this.length,b,c;0<--a;)b=Math.random()*(a+1)|0,c=this[b],this[b]=this[a],this[a]=c;return this},clone:function(){return this.slice(0)},random:function(){var a=
this.clone().shuffle();return a[Math.random()*a.length|0]},addOne:function(a){a={data:a};a._id=a.data._id||this._generateUID();if(this.indices._id.hasOwnProperty(a._id))this[this.indices._id[a._id]]=a;else{var b=this.length++;this[b]=a;this.indices._id[a._id]=b}this._setLastUpdate();return this},add:function(){for(var a=0,b=arguments.length;a<b;++a)this.addOne(arguments[a]);return this},toArray:function(){var a=[];this.each(function(b,c){a.push(c)});return a},slice:function(a,d){return new b(Array.prototype.slice.call(this,
a,d))},pop:function(){var a=Array.prototype.pop.call(this);this.reIndex();return a},shift:function(){var a=Array.prototype.shift.call(this);this.reIndex();return a},flush:function(){for(var a=0,b=this.length;a<b;++a)delete this[a];return this._init()}};if("undefined"!==typeof module&&module.exports)module.exports=b;else if(window)window.yerba=b;else return b})(function(){function e(){}e.prototype={genUID:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var c=16*
Math.random()|0;return("x"===b?c:c&3|8).toString(16)})},isFunction:function(b){return"[object Function]"===Object.prototype.toString.call(b)},isString:function(b){return"string"===typeof b||b instanceof String},isNumber:function(b){return!isNaN(parseFloat(b))&&isFinite(b)},isObject:function(b){return b===Object(b)&&"[object Array]"!==Object.prototype.toString.call(b)},isArray:Array.isArray||function(b){return"[object Array]"===Object.prototype.toString.call(b)}};return new e}());
