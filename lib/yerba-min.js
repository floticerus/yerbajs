/*
 yerbajs - simple javascript data management
  @copyright 2014 Kevin von Flotow <vonflow@gmail.com>
  @license MIT License <http://opensource.org/licenses/MIT>
*/
(function(){function e(a){this._init(a)}function m(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)})}function l(a){return"string"===typeof a||a instanceof String}function g(a){return!isNaN(parseFloat(a))&&isFinite(a)}var n=Date.prototype.toISOString?"toISOString":"getTime";e.prototype={_init:function(a){a=a||[];for(var b=this.length=this.lastUpdate=0,c=a.length;b<c;b++)this.add(a[b])},_setLastUpdate:function(){this.lastUpdate=
(new Date)[n]()},_generateUID:function(){var a=m();return this.get(a)?this._generateUID():a},each:function(a){for(var b=0,c=this.length;b<c;++b){var d=a.call(this,b,this[b]);if(!d&&"undefined"!==typeof d)break}return this},get:function(a){for(var b=0,c=this.length;b<c;++b)if(this[b]._id===a)return this[b];return!1},find:function(a){if(!a)return!1;var b=void 0,c={},d=function(a){};"[object Function]"===Object.prototype.toString.call(a)?d=a:(b="undefined"!==typeof a.query?a.query:b,c=a.opts||c,d=a.done||
d);c.caseSensitive="undefined"!==typeof c.caseSensitive?c.caseSensitive:!0;c.limit="undefined"!==typeof c.limit&&g(c.limit)?c.limit|0:0;var e=[];this.each(function(a,d){var h=0,k=0;if(l(b)||g(b))h=1,"undefined"!==typeof d.value&&d.value==b&&(k=1);else for(var f in b)d.hasOwnProperty(f)&&(c.caseSensitive&&d[f]===b[f]||!c.caseSensitive&&d[f].toLowerCase()===b[f].toLowerCase())&&k++,h++;if(k===h&&(e.push(d),0<c.limit&&e.length>=c.limit))return!1});d.call(this,e);return this},shuffle:function(){for(var a=
this.length,b,c;0<--a;)b=Math.random()*(a+1)|0,c=this[b],this[b]=this[a],this[a]=c;return this},clone:function(){return this.slice(0)},random:function(){var a=this.clone().shuffle();return a[Math.random()*a.length|0]},addOne:function(a){if(l(a)||g(a))a={value:a};a._id=a._id||this._generateUID();if(this.get(a._id))for(var b=0,c=this.length;b<c;++b){if(this[b]._id===a._id){this[b]=a;break}}else this[this.length++]=a;this._setLastUpdate();return this},add:function(){for(var a=0,b=arguments.length;a<
b;++a)this.addOne(arguments[a]);return this},toArray:function(){var a=[];this.each(function(b,c){a.push(c)});return a},slice:function(a,b){return new e(Array.prototype.slice.call(this,a,b))},pop:function(){return Array.prototype.pop.call(this)},shift:function(){return Array.prototype.shift.call(this)},flush:function(){for(var a=0,b=this.length;a<b;++a)delete this[a];this.length=0;return this}};if("undefined"!==typeof module&&module.exports)module.exports=e;else if(window)window.yerba=e;else return e})();
